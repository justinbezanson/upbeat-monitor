services:
  # Backend API (Go)
  # Currently runs main.go in the root.
  api:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: upbeat-api
    ports:
      - "${API_PORT}:${API_PORT}" # Use variable for port mapping
    env_file:
      - ./.env # Explicitly load .env file
    volumes:
      - .:/app
    working_dir: /app
    command: go run cmd/api/main.go
    restart: unless-stopped

  # Future services based on your documentation (Uncomment when ready):
  
  # Frontend SPA (Vue)
  web:
    build:
      context: ./frontend
      dockerfile: Dockerfile.frontend
    container_name: upbeat-frontend
    depends_on:
      - api
    ports:
      - "80:80"
    restart: unless-stopped
